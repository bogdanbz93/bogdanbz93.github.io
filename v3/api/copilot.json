{
  "openapi": "3.0.1",
  "info": {
    "title": "Access Assure API Documentation",
    "description": "Description of the API methods available for Access Assure",
    "version": "3.8.0"
  },
  "servers": [
    {
      "url": "https://yqm9d5ki4j.execute-api.us-east-1.amazonaws.com/Stage",
      "description": "Updated server url"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "tags": ["evo-controller"],
        "summary": "General query endpoint for Access Assure",
        "description": "Use this endpoint for almost all general questions about **Access Assure**.\n\n**Usage instructions:**\n- Both `CoPilotMessage` and `ExtractChatHistory` parameters are **mandatory**, if they exist.\n- Do **not** add any extra information beyond what is already available — return only what the API provides.\n- The returned information must be presented **faithfully**, without heavy rewording or additional commentary.\n\n**Language handling:**\n- If the user asks a question in another language, send the `coPilotMessage` in **English**, but return the final answer in the **same language** as the user’s query.\n\n**If no relevant result is found:**\n- Return the message: *“I am sorry, I could not find any information related to your question in Access Assure documentation. We will update our documentation soon.”*",
        "operationId": "AskAboutAssure",
        "parameters": [
          {
            "name": "coPilotMessage",
            "in": "query",
            "required": true,
            "schema": { "type": "string" }
          },
          {
            "name": "extractChatHistory",
            "in": "query",
            "required": false,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": {
            "description": "Access Assure description returned successfully",
            "content": {
              "*/*": { "schema": { "type": "string" } }
            }
          }
        }
      }
    },
    "/discovery": {
      "get": {
        "tags": ["evo-controller"],
        "operationId": "getDiscovery",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "type": "object",
                  "additionalProperties": { "type": "object" }
                }
              }
            }
          }
        }
      }
    },
    "/report": {
      "get": {
        "tags": ["report-controller"],
        "summary": "Request the most recent LLM (AI) report for a given service user",
        "description": "Returns the latest LLM-generated report (AI Summary) for the specified Service User (patient). The response includes Key Changes, Daily Routine, Activity Levels, Weekday vs. Weekend Trends, Bathroom Activity, Special Observations, and Conclusions. The report is returned in **Markdown** format.\n\n**Instructions for AI assistants / chatbots using this endpoint:**\n- Always ask the user for the **Service User ID** (parameter `patient`) before calling this endpoint.\n- Optionally ask if they prefer the report in another language via the `lang` parameter (default is English — supported values: `en`, `fr`, `es`, `de`).\n- **Do not create or display any charts, graphs, or images.** Only return or summarize text.\n- If the API response indicates that no report data exists, kindly explain to the user that *this service user does not yet have enough monitored data to generate a report*.\n- After delivering the report, explicitly ask the user: *“Would you like me to provide a brief summary of this report?”*.\n  - If the user says **yes**, generate a short, natural-language summary of the key insights.\n  - If the user says **no**, politely offer: *“Would you like me to get the report for another service user instead?”*.\n- **If the report was generated in Spanish, French, or German (based on the `lang` parameter), automatically continue the conversation in that same language**, including summaries and follow-up questions.\n- Maintain a professional and empathetic tone throughout the interaction, keeping the conversation concise and focused.",
        "operationId": "getLatestReport",
        "parameters": [
          {
            "name": "patient",
            "in": "query",
            "description": "The Service User ID for whom to retrieve the latest report",
            "required": true,
            "schema": { "type": "string", "example": "622" }
          },
          {
            "name": "lang",
            "in": "query",
            "description": "Optional language code for the report (default: en). Supported: en, fr, es, de",
            "required": false,
            "schema": { "type": "string", "example": "en" }
          }
        ],
        "responses": {
          "200": {
            "description": "Latest report returned successfully (in Markdown format)",
            "content": {
              "text/markdown": {
                "schema": {
                  "type": "string",
                  "example": "### Rutina diaria\nJuan se despierta alrededor de las 8 AM y prepara el desayuno..."
                }
              }
            }
          },
          "204": {
            "description": "No report available — insufficient monitored data for this service user",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "This service user does not yet have enough monitored data to generate a report."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Missing or invalid parameters",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": { "schemas": {} }
}
